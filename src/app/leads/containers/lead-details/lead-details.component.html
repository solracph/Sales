<div class="row no-gutters lead-versions main-row">
    <div class="col-xl-2" *ngIf="(user$ | async).role == 200">
        <div class="md-card">
            <div class="md-card-heading title-with-small-icon">
                <mat-icon class="material-icons">list</mat-icon>
                <span class="md-card-title" >
                    Lead History
                </span>
            </div>
            <mat-divider></mat-divider>
            <ng-container *ngIf="versions$ | async; let versions;">
                <app-lead-versions-list 
                    [selected]="selectedLead$ | async"
                    [versions]="versions" 
                    (leadSelected)="onLeadSelection($event)">
                </app-lead-versions-list>
            </ng-container>
        </div>
    </div>
    <div [class]="'col-xl-12'">
        <div *ngIf="selectedLead$ | async; let selectedLead;">
            <div class="row">
                <div class="col-xl-12">
                    <div class="md-card">
                        <!--<div class="md-card-heading pb-0">
                            <div class="md-card-title title-with-small-icon ml-3">
                                <mat-icon class="material-icons">{{selectedLead.state == leadState.new ? "person_add": "edit"}}</mat-icon>
                                <span class="ml-2">{{lselectedLeadstate == leadState.new ? "New": "Edit"}} Lead</span>
                            </div>
                        </div>-->
                        <div class="md-card-body">
                            <scrollable [heightOffset]="150">
                                <ng-container *ngIf="selectedLead.state != 3 ">
                                    <app-lead-form 
                                        [lead]="selectedLead"
                                        [sources]="sources$ | async"
                                        [reasons]="reasons$ | async"
                                        [plans]="plans$ | async"
                                        [outcomes]="outcomes$ | async"
                                        [user]="user$ | async"
                                        
                                        (leadSaved)="leadSaved($event)"
                                        (formValueChanged)="formValueChange($event)"
                                    
                                    ></app-lead-form>
                                </ng-container>
                                <ng-container *ngIf="selectedLead.state == 3">
                                    <app-lead-view
                                        [lead]="selectedLead"
                                        [sources]="sources$ | async"
                                        [reasons]="reasons$ | async"
                                        [plans]="plans$ | async"
                                        [outcomes]="outcomes$ | async"
                                    ></app-lead-view>
                                </ng-container>
                                <div class="events-notes-container" *ngIf="selectedLead.state != 2 "> 
                                    <div  class="row">
                                        <div class="col-xl-6">
                                            <app-lead-notes-box 
                                                [notes]="notes$ | async" 
                                                [user]="user$ | async" 
                                                [lead]="selectedLead"
                                                (newNoteDialog)="newNoteDialog($event)"
                                                (editNoteDialog)="editNoteDialog($event)"> </app-lead-notes-box>
                                        </div>
                                        <div class="col-xl-6">
                                            <app-lead-events-box 
                                                [events]="events$ | async" 
                                                [outcomes]="outcomes$ | async" 
                                                [user]="user$ | async" 
                                                [lead]="selectedLead"
                                                (newEventDialog)="newEventDialog($event)"
                                                (editEventDialog)="editEventDialog($event)"></app-lead-events-box>
                                        </div>
                                    </div>
                                </div>
                            </scrollable>
                        </div>
                    </div>
                </div>
            </div>
                
        </div>
    </div>
</div>




